## MongoDB 기반 이커머스 시스템의 MySQL 전환 및 성능 개선 보고서

---

## 0. 프로젝트 개요

기존 MongoDB 기반 이커머스 API는 중첩 문서 구조로 인해 **트랜잭션 불가로 일관성 유지 어려움**, **정합성 부족**, **N+1 조회**, **재고 처리 불가**, **참조 무결성을 고려한 삭제 로직 부재** 등의 문제가 있었다. 이를 해결하기 위해 **MySQL + Prisma 기반 RDB 구조로 전면 재설계**하고, 핵심 비즈니스 로직을 새롭게 구현하였다.

---

## 핵심 개선 사항

### **1) 데이터 모델 정규화 및 무결성 강화**

* User / Address / Product / ProductOption / Order / OrderItem / Delivery / Customer로 **제3정규화 재설계**
* 삭제·병합·수정 시 참조 무결성 보장
* 주문·배송·고객 정보가 독립적으로 관리되어 분석과 운영이 가능해짐

---

### **2) 트랜잭션 기반 비즈니스 로직 구현**

기존 MongoDB에서는 불가능했던 다음 로직을 **원자적 트랜잭션**으로 보장:

* **재고 차감 및 재고 부족 처리**
* **카테고리 재정렬 / 병합 기능**
* **상품 옵션 전체 교체 및 재고 변경**
* **주문 생성·수정·삭제의 원자성 보장**

➡ **도메인 간 의존성을 하나의 사용자 액션 단위로 안정적으로 처리할 수 있게 됨**

---

### **3) 조회 성능 최적화 및 인덱스 튜닝**

| API        | Before | After  | 개선폭    |
| ---------- | ------ | ------ | ------ |
| 주문 상세 조회   | 16.8ms | 14.6ms | 🔽 13% |
| 카테고리 상품 조회 | 13.6ms | 9.6ms  | 🔽 29% |

* Full Scan → Index Search로 전환
* 조인 비용 감소 및 조건 기반 검색 성능 개선

---

### **4) 테스트 자동화 구축**

* **98개의 테스트 케이스**
* 전체 **91%+ 커버리지 (Statements 91.75%, Functions 92.9%)**
* 실제 Prisma Client 대신 **SQLite 전용 Prisma Client 기반 통합테스트 구성**

➡ **회귀 안정성 보장 & 배포 전 신뢰도 상승**

---

### **5) 부하 테스트(Artillery) 기반 성능 검증**

동일 환경에서 SQL 서버는 NoSQL 대비:

* 전체 조회: **평균 90% 빠른 응답**
* 주문 조회: **평균 39ms (성공률 100%)**
* 주문 생성: **평균 49ms, P99 108ms 유지**
* NoSQL 대비 tail latency 최대 **89% 감소**

➡ **고부하에서도 안정적으로 동작하는 구조로 개선됨**

더 자세한 부하 테스트 시나리오 & 결과: [docs/performance.md](./docs/performance.md)

---

## 기술적/비즈니스 성과 요약

* 중첩 문서 구조 → **정규화된 RDB 스키마로 전환**
* 트랜잭션 전면 도입 → **데이터 정합성 + 운영 안정성 획득**
* 재고/카테고리/삭제 등의 **핵심 비즈니스 로직 새롭게 구현**
* 인덱싱 및 쿼리 개선 → **카테고리/주문 조회 성능 최대 29% 향상**
* 98개 테스트 + 부하 테스트 → **운영 서비스 수준의 품질 확보**
* SQL 전환 후 **성공률·처리 속도·지연 안정성 모두 대폭 개선**

---

더 자세한 보고서 내용은 [Full Report (PDF)](./docs/MongoDB%20기반%20이커머스%20시스템의%20MySQL%20전환%20및%20성능%20개선%20보고서.pdf)에서 확인할 수 있습니다.

